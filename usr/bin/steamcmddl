#!/bin/bash

# Check if steamcmd already exists
if [ ! -d "$HOME/.steamcmd" ];
then 
	echo "$HOME/.steamcmd does not exist. If this is the first time you run this script, this is normal. steamcmddl will now download steamcmd."
	mkdir -p "$HOME/.steamcmd"
	wget --output-document="$HOME/.steamcmd/steamcmd_linux.tar.gz" "https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz"
	tar -xvzf "$HOME/.steamcmd/steamcmd_linux.tar.gz" -C "$HOME/.steamcmd"
	chmod +x "$HOME/.steamcmd/*"
else
	echo ".steamcmd already exists. Assuming steamcmd is already downloaded to .steamcmd..."
fi


USERFILE="$HOME/.steamcmd/steamcmddlusername.txt"
APPIDFILE="$HOME/.steamcmd/steamcmddlappid.txt"

dialog --title "Steam login" \
--backtitle "Steam CMD DL Tool - Made by ev1l0rd" \
--inputbox "Enter steam username" 8 60 2>$USERFILE


dialog --title "AppId" \
--backtitle "Steam CMD DL Tool - Made by ev1l0rd" \
--inputbox "Enter your appid" 8 60 2>$APPIDFILE

USERNAME=$(<$USERFILE)
APPID=$(<$APPIDFILE)

$HOME/.steamcmd/steamcmd.sh +@sSteamCmdForcePlatformType windows +login $USERNAME +force_install_dir $HOME/steamcmddl/$APPID +app_update $APPID +quit

rm $USERFILE
rm $APPIDFILE
